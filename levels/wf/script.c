#include <ultra64.h>
#include "sm64.h"
#include "behavior_data.h"
#include "model_ids.h"
#include "seq_ids.h"
#include "dialog_ids.h"
#include "segment_symbols.h"
#include "level_commands.h"

#include "game/level_update.h"

#include "levels/scripts.h"

#include "actors/common1.h"
#include "make_const_nonconst.h"
#include "levels/wf/header.h"

/* Fast64 begin persistent block [scripts] */
/* Fast64 end persistent block [scripts] */

const LevelScript level_wf_entry[] = {
	INIT_LEVEL(),
	LOAD_YAY0(0x07, _wf_segment_7SegmentRomStart, _wf_segment_7SegmentRomEnd), 
	LOAD_YAY0(0x0A, _cloud_floor_skybox_yay0SegmentRomStart, _cloud_floor_skybox_yay0SegmentRomEnd), 
	LOAD_YAY0_TEXTURE(0x09, _grass_yay0SegmentRomStart, _grass_yay0SegmentRomEnd), 
	LOAD_YAY0(0x05, _group1_yay0SegmentRomStart, _group1_yay0SegmentRomEnd), 
	LOAD_RAW(0x0C, _group1_geoSegmentRomStart, _group1_geoSegmentRomEnd), 
	LOAD_YAY0(0x06, _group14_yay0SegmentRomStart, _group14_yay0SegmentRomEnd), 
	LOAD_RAW(0x0D, _group14_geoSegmentRomStart, _group14_geoSegmentRomEnd), 
	LOAD_YAY0(0x08, _common0_yay0SegmentRomStart, _common0_yay0SegmentRomEnd), 
	LOAD_RAW(0x0F, _common0_geoSegmentRomStart, _common0_geoSegmentRomEnd), 
	ALLOC_LEVEL_POOL(),
	MARIO(MODEL_MARIO, 0x00000001, bhvMario), 
	JUMP_LINK(script_func_global_1), 
	JUMP_LINK(script_func_global_2), 
	JUMP_LINK(script_func_global_15), 
	LOAD_MODEL_FROM_GEO(MODEL_WF_BUBBLY_TREE, bubbly_tree_geo), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_03, wf_geo_0007E0), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_04, wf_geo_000820), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_05, wf_geo_000860), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_06, wf_geo_000878), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_07, wf_geo_000890), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_08, wf_geo_0008A8), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_09, wf_geo_0008E8), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_0A, wf_geo_000900), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_0C, wf_geo_000940), 
	LOAD_MODEL_FROM_GEO(MODEL_WF_GIANT_POLE, wf_geo_000AE0), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_0E, wf_geo_000958), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_0F, wf_geo_0009A0), 
	LOAD_MODEL_FROM_GEO(MODEL_WF_ROTATING_PLATFORM, wf_geo_0009B8), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_11, wf_geo_0009D0), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_12, wf_geo_0009E8), 
	LOAD_MODEL_FROM_GEO(MODEL_WF_SMALL_BOMP, wf_geo_000A00), 
	LOAD_MODEL_FROM_GEO(MODEL_WF_LARGE_BOMP, wf_geo_000A40), 
	LOAD_MODEL_FROM_GEO(MODEL_WF_ROTATING_WOODEN_PLATFORM, wf_geo_000A58), 
	LOAD_MODEL_FROM_GEO(MODEL_WF_SLIDING_PLATFORM, wf_geo_000A98), 
	LOAD_MODEL_FROM_GEO(MODEL_WF_TUMBLING_BRIDGE_PART, wf_geo_000AB0), 
	LOAD_MODEL_FROM_GEO(MODEL_WF_TUMBLING_BRIDGE, wf_geo_000AC8), 
	LOAD_MODEL_FROM_GEO(MODEL_WF_TOWER_TRAPEZOID_PLATORM, wf_geo_000AF8), 
	LOAD_MODEL_FROM_GEO(MODEL_WF_TOWER_SQUARE_PLATORM, wf_geo_000B10), 
	LOAD_MODEL_FROM_GEO(MODEL_WF_TOWER_SQUARE_PLATORM_UNUSED, wf_geo_000B38), 
	LOAD_MODEL_FROM_GEO(MODEL_WF_TOWER_SQUARE_PLATORM_ELEVATOR, wf_geo_000B60), 
	LOAD_MODEL_FROM_GEO(MODEL_WF_BREAKABLE_WALL_RIGHT, wf_geo_000B78), 
	LOAD_MODEL_FROM_GEO(MODEL_WF_BREAKABLE_WALL_LEFT, wf_geo_000B90), 
	LOAD_MODEL_FROM_GEO(MODEL_WF_KICKABLE_BOARD, wf_geo_000BA8), 
	LOAD_MODEL_FROM_GEO(MODEL_WF_TOWER_DOOR, wf_geo_000BE0), 
	LOAD_MODEL_FROM_GEO(MODEL_WF_KICKABLE_BOARD_FELLED, wf_geo_000BC8), 
	/* Fast64 begin persistent block [level commands] */
	/* Fast64 end persistent block [level commands] */

	AREA(1, wf_area_1),
		WARP_NODE(0xF1, LEVEL_CASTLE, 0x01, 0x66, WARP_NO_CHECKPOINT),
		WARP_NODE(0xF0, LEVEL_CASTLE, 0x01, 0x34, WARP_NO_CHECKPOINT),
		WARP_NODE(0x0C, LEVEL_WF, 0x01, 0x0B, WARP_NO_CHECKPOINT),
		WARP_NODE(0x0B, LEVEL_WF, 0x01, 0x0C, WARP_NO_CHECKPOINT),
		WARP_NODE(0x0A, LEVEL_WF, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		OBJECT_WITH_ACTS(MODEL_1UP, -384, 3584, 6, 0, 0, 0, 0x00000000, bhv1Up, ACT_3 | ACT_4 | ACT_5 | ACT_6),
		OBJECT(MODEL_NONE, -856, 922, 3819, 0, 0, 0, 0x00000000, bhvBetaFishSplashSpawner),
		OBJECT(MODEL_BLUE_COIN_SWITCH, -2500, 384, -250, 0, 0, 0, 0x00000000, bhvBlueCoinSwitch),
		OBJECT_WITH_ACTS(MODEL_BOBOMB_BUDDY, -1700, 1140, 3500, 0, 0, 0, 0x00000000, bhvBobombBuddyOpensCannon, ACT_4 | ACT_5 | ACT_6),
		OBJECT(MODEL_BREAKABLE_BOX, 4320, 256, 1880, 0, 0, 0, 0x00000000, bhvBreakableBoxSmall),
		OBJECT(MODEL_BREAKABLE_BOX, -2940, 384, -1320, 0, 0, 0, 0x00000000, bhvBreakableBoxSmall),
		OBJECT_WITH_ACTS(MODEL_BULLET_BILL, 1280, 3712, 968, 0, -180, 0, 0x00000000, bhvBulletBill, ACT_3 | ACT_4 | ACT_5 | ACT_6),
		OBJECT_WITH_ACTS(MODEL_LEVEL_GEOMETRY_09, 1280, 3584, 896, 0, 0, 0, 0x00000000, bhvBulletBillCannon, ACT_3 | ACT_4 | ACT_5 | ACT_6),
		OBJECT(MODEL_BUTTERFLY, 4736, 256, 4992, 0, 0, 0, 0x00000000, bhvButterfly),
		OBJECT(MODEL_BUTTERFLY, 4608, 256, 5120, 0, 0, 0, 0x00000000, bhvButterfly),
		OBJECT(MODEL_BUTTERFLY, 4608, 256, 4992, 0, 0, 0, 0x00000000, bhvButterfly),
		OBJECT(MODEL_BUTTERFLY, 4608, 256, 4864, 0, 0, 0, 0x00000000, bhvButterfly),
		OBJECT(MODEL_BUTTERFLY, 4480, 256, 4992, 0, 0, 0, 0x00000000, bhvButterfly),
		OBJECT(MODEL_BUTTERFLY, 4608, 256, 256, 0, 0, 0, 0x00000000, bhvButterfly),
		OBJECT(MODEL_BUTTERFLY, 4736, 256, 128, 0, 0, 0, 0x00000000, bhvButterfly),
		OBJECT(MODEL_BUTTERFLY, 4480, 256, 128, 0, 0, 0, 0x00000000, bhvButterfly),
		OBJECT(MODEL_BUTTERFLY, 4608, 256, 0, 0, 0, 0, 0x00000000, bhvButterfly),
		OBJECT(MODEL_BUTTERFLY, 4608, 256, 128, 0, 0, 0, 0x00000000, bhvButterfly),
		OBJECT(MODEL_DL_CANNON_LID, -1844, 1026, 3893, 0, 0, 0, (0x40 << 16), bhvCannonClosed),
		OBJECT(MODEL_NONE, 1035, 2880, -900, 0, 45, 0, 0x00000000, bhvCheckerboardElevatorGroup),
		OBJECT(MODEL_NONE, 3760, 960, 2740, 0, 0, 0, ((COIN_FORMATION_FLAG_NONE                             ) << 16), bhvCoinFormation),
		OBJECT(MODEL_NONE, -1400, 1160, 3900, 0, 90, 0, ((COIN_FORMATION_FLAG_NONE                             ) << 16), bhvCoinFormation),
		OBJECT(MODEL_NONE, 1254, 2586, 2299, 0, 90, 0, ((COIN_FORMATION_FLAG_NONE                             ) << 16), bhvCoinFormation),
		OBJECT(MODEL_NONE, -2500, 1795, -260, 0, 0, 0, ((COIN_FORMATION_FLAG_RING                             ) << 16), bhvCoinFormation),
		OBJECT(MODEL_NONE, 1215, 3600, -2609, 0, 135, 0, ((COIN_FORMATION_FLAG_ARROW                            ) << 16), bhvCoinFormation),
		OBJECT(MODEL_NONE, 4611, 256, 141, 0, 0, 0, ((COIN_FORMATION_FLAG_RING                             ) << 16), bhvCoinFormation),
		OBJECT(MODEL_NONE, 1558, 922, 2329, 0, 0, 0, ((COIN_FORMATION_FLAG_RING                             ) << 16), bhvCoinFormation),
		OBJECT(MODEL_NONE, 3396, 1380, 3280, 0, 0, 0, ((COIN_FORMATION_FLAG_NONE                             ) << 16), bhvCoinFormation),
		OBJECT(MODEL_NONE, 3234, 3345, -1787, 0, 0, 0, ((COIN_FORMATION_FLAG_FLYING | COIN_FORMATION_FLAG_RING) << 16), bhvCoinFormation),
		OBJECT(MODEL_EXCLAMATION_BOX, 3937, 1370, -3942, 0, 0, 0, (EXCLAMATION_BOX_BP_METAL_CAP << 16), bhvExclamationBox),
		OBJECT(MODEL_NONE, -2925, 2560, -947, 0, 19, 0, 0x000B0000, bhvFadingWarp),
		OBJECT(MODEL_NONE, 2548, 1075, -3962, 0, 51, 0, 0x000C0000, bhvFadingWarp),
		OBJECT(MODEL_WF_GIANT_POLE, -2560, 2560, -256, 0, 0, 0, 0x00000000, bhvGiantPole),
		OBJECT(MODEL_1UP, -250, 2650, 2400, 0, 0, 0, (2 << 16), bhvHidden1up),
		OBJECT(MODEL_NONE, -2500, 4560, -256, 0, 0, 0, 0x00000000, bhvHidden1upInPoleSpawner),
		OBJECT(MODEL_NONE, 0, 2650, 2900, 0, 0, 0, 0x00000000, bhvHidden1upTrigger),
		OBJECT(MODEL_NONE, -500, 2650, 2900, 0, 0, 0, 0x00000000, bhvHidden1upTrigger),
		OBJECT(MODEL_BLUE_COIN, -2500, 450, -1150, 0, 0, 0, 0x00000000, bhvHiddenBlueCoin),
		OBJECT(MODEL_BLUE_COIN, -2500, 450, -900, 0, 0, 0, 0x00000000, bhvHiddenBlueCoin),
		OBJECT(MODEL_BLUE_COIN, -2500, 450, -650, 0, 0, 0, 0x00000000, bhvHiddenBlueCoin),
		OBJECT(MODEL_BLUE_COIN, -2500, 450, -1400, 0, 0, 0, 0x00000000, bhvHiddenBlueCoin),
		OBJECT(MODEL_NONE, 4600, 550, 2500, 0, 0, 0, 0x03000000, bhvHiddenRedCoinStar),
		OBJECT_WITH_ACTS(MODEL_HOOT, 2560, 700, 4608, 0, 0, 0, 0x00000000, bhvHoot, ACT_4 | ACT_5 | ACT_6),
		OBJECT_WITH_ACTS(MODEL_WF_KICKABLE_BOARD, 13, 3584, -1407, 0, -45, 0, 0x00000000, bhvKickableBoard, ACT_3 | ACT_4 | ACT_5 | ACT_6),
		OBJECT(MODEL_WF_LARGE_BOMP, 3300, 1070, 641, 0, 0, 0, 0x00000000, bhvLargeBomp),
		OBJECT(MODEL_WOODEN_SIGNPOST, 4200, 256, 5160, 0, -45, 0, (DIALOG_018 << 16), bhvMessagePanel),
		OBJECT(MODEL_WOODEN_SIGNPOST, -2540, 2560, -900, 0, 0, 0, (DIALOG_036 << 16), bhvMessagePanel),
		OBJECT(MODEL_WOODEN_SIGNPOST, 1600, 2560, 2600, 0, 90, 0, (DIALOG_042 << 16), bhvMessagePanel),
		OBJECT(MODEL_WOODEN_SIGNPOST, -2705, 2560, 59, 0, -90, 0, (DIALOG_051 << 16), bhvMessagePanel),
		OBJECT(MODEL_WOODEN_SIGNPOST, 3460, 2304, -40, 0, -180, 0, (DIALOG_096 << 16), bhvMessagePanel),
		OBJECT(MODEL_WOODEN_SIGNPOST, -2932, 386, -157, 0, -90, 0, (DIALOG_078 << 16), bhvMessagePanel),
		OBJECT(MODEL_WOODEN_SIGNPOST, 4800, 256, 3000, 0, 0, 0, (DIALOG_104 << 16), bhvMessagePanel),
		OBJECT(MODEL_WOODEN_SIGNPOST, 3467, 1075, -3934, 0, 90, 0, (DIALOG_113 << 16), bhvMessagePanel),
		OBJECT(MODEL_PIRANHA_PLANT, 1822, 2560, -101, 0, 90, 0, 0x00000000, bhvPiranhaPlant),
		OBJECT(MODEL_PIRANHA_PLANT, 4625, 256, 5017, 0, -90, 0, 0x00000000, bhvPiranhaPlant),
		OBJECT(MODEL_NONE, -2495, 1331, -256, 0, 0, 0, 0x003D0000, bhvPoleGrabbing),
		OBJECT(MODEL_RED_COIN, -250, 2650, 2970, 0, 0, 0, 0x00000000, bhvRedCoin),
		OBJECT(MODEL_RED_COIN, 1746, 3620, -3120, 0, 0, 0, 0x00000000, bhvRedCoin),
		OBJECT(MODEL_RED_COIN, 1277, 2600, 1350, 0, 0, 0, 0x00000000, bhvRedCoin),
		OBJECT(MODEL_RED_COIN, 1585, 2595, -80, 0, 0, 0, 0x00000000, bhvRedCoin),
		OBJECT(MODEL_RED_COIN, 3350, 3000, -1520, 0, 0, 0, 0x00000000, bhvRedCoin),
		OBJECT(MODEL_RED_COIN, 2700, 3600, -900, 0, 0, 0, 0x00000000, bhvRedCoin),
		OBJECT(MODEL_RED_COIN, 3770, 1380, 650, 0, 0, 0, 0x00000000, bhvRedCoin),
		OBJECT(MODEL_RED_COIN, -270, 1720, 2250, 0, 0, 0, 0x00000000, bhvRedCoin),
		OBJECT(MODEL_WF_ROTATING_PLATFORM, 2304, 3584, -2303, 0, 0, 0, 0x08000000, bhvRotatingPlatform),
		OBJECT(MODEL_WF_ROTATING_PLATFORM, 3200, 3328, -1791, 0, 0, 0, 0x08000000, bhvRotatingPlatform),
		OBJECT(MODEL_WF_ROTATING_PLATFORM, 2688, 3584, -895, 0, 0, 0, 0x08000000, bhvRotatingPlatform),
		OBJECT(MODEL_WF_SMALL_BOMP, 3300, 1070, 1, 0, 90, 0, 0x00000000, bhvSmallBomp),
		OBJECT(MODEL_WF_SMALL_BOMP, 3300, 1070, 1281, 0, 90, 0, 0x00000000, bhvSmallBomp),
		OBJECT(MODEL_WHOMP, -1545, 2560, -286, 0, 0, 0, 0x00000000, bhvSmallWhomp),
		OBJECT(MODEL_WHOMP, 189, 2560, -1857, 0, -135, 0, 0x00000000, bhvSmallWhomp),
		OBJECT(MODEL_NONE, 2600, 1256, 5120, 0, 90, 0, 0x000A0000, bhvSpinAirborneWarp),
		OBJECT_WITH_ACTS(MODEL_STAR, 300, 5550, 0, 0, 0, 0, 0x01000000, bhvStar, ACT_3 | ACT_4 | ACT_5 | ACT_6),
		OBJECT(MODEL_STAR, -2500, 1500, -750, 0, 0, 0, 0x02000000, bhvStar),
		OBJECT(MODEL_STAR, 2880, 4300, 190, 0, 0, 0, 0x04000000, bhvStar),
		OBJECT(MODEL_STAR, 590, 2450, 2650, 0, 0, 0, 0x05000000, bhvStar),
		OBJECT(MODEL_LEVEL_GEOMETRY_06, 0, 0, 0, 0, 0, 0, 0x00000000, bhvStaticObject),
		OBJECT(MODEL_LEVEL_GEOMETRY_07, 1757, 3519, -3151, 0, 0, 0, 0x00000000, bhvStaticObject),
		OBJECT(MODEL_LEVEL_GEOMETRY_0C, 1408, 2522, 2431, 0, 0, 0, 0x00000000, bhvStaticObject),
		OBJECT(MODEL_LEVEL_GEOMETRY_11, -2499, 1792, -261, 0, 0, 0, 0x00000000, bhvStaticObject),
		OBJECT(MODEL_LEVEL_GEOMETRY_12, -2661, 384, 640, 0, 0, 0, 0x00000000, bhvStaticObject),
		OBJECT(MODEL_THWOMP, 3462, 1939, -1545, 0, -180, 0, 0x00000000, bhvThwomp),
		OBJECT(MODEL_THWOMP, 3462, 1075, -3314, 0, 90, 0, 0x00000000, bhvThwomp2),
		OBJECT_WITH_ACTS(MODEL_LEVEL_GEOMETRY_08, 0, 3584, 0, 0, 0, 0, 0x00000000, bhvTower, ACT_2 | ACT_3 | ACT_4 | ACT_5 | ACT_6),
		OBJECT_WITH_ACTS(MODEL_WF_TOWER_DOOR, -511, 3584, 0, 0, 0, 0, 0x00000000, bhvTowerDoor, ACT_2 | ACT_3 | ACT_4 | ACT_5 | ACT_6),
		OBJECT_WITH_ACTS(MODEL_NONE, 0, 3483, 0, 0, 0, 0, 0x00000000, bhvTowerPlatformGroup, ACT_2 | ACT_3 | ACT_4 | ACT_5 | ACT_6),
		OBJECT(MODEL_BOB_BUBBLY_TREE, 2560, 256, 4608, 0, 0, 0, 0x00000000, bhvTree),
		OBJECT(MODEL_BUTTERFLY, 4574, 300, 1130, 0, 0, 0, (TRIPLET_BUTTERFLY_BP_NO_BOMBS << 16), bhvTripletButterfly),
		OBJECT(MODEL_WF_BREAKABLE_WALL_LEFT, -1023, 2176, 2944, 0, 0, 0, 0x00000000, bhvWfBreakableWallLeft),
		OBJECT(MODEL_WF_BREAKABLE_WALL_RIGHT, 512, 2176, 2944, 0, 0, 0, 0x00000000, bhvWfBreakableWallRight),
		OBJECT(MODEL_WF_ROTATING_WOODEN_PLATFORM, -255, 2560, 2304, 0, 0, 0, 0x00000000, bhvWfRotatingWoodenPlatform),
		OBJECT(MODEL_WF_SLIDING_PLATFORM, 3328, 1075, -1791, 0, 90, 0, 0x00020000, bhvWfSlidingPlatform),
		OBJECT(MODEL_WF_SLIDING_PLATFORM, 3328, 1075, -767, 0, 90, 0, 0x00010000, bhvWfSlidingPlatform),
		OBJECT(MODEL_WF_SLIDING_PLATFORM, 3328, 1075, -2815, 0, 90, 0, 0x00030000, bhvWfSlidingPlatform),
		OBJECT(MODEL_WF_TUMBLING_BRIDGE, 1792, 2496, 1600, 0, 0, 0, 0x00000000, bhvWfTumblingBridge),
		OBJECT_WITH_ACTS(MODEL_WHOMP, 0, 3584, 0, 0, 0, 0, 0x00000000, bhvWhompKingBoss, ACT_1),
		OBJECT(MODEL_YELLOW_COIN, 0, 2650, 2900, 0, 0, 0, 0x00000000, bhvYellowCoin),
		OBJECT(MODEL_YELLOW_COIN, -500, 2650, 2900, 0, 0, 0, 0x00000000, bhvYellowCoin),
		OBJECT(MODEL_YELLOW_COIN, 250, 2650, 2800, 0, 0, 0, 0x00000000, bhvYellowCoin),
		OBJECT(MODEL_YELLOW_COIN, -750, 2650, 2800, 0, 0, 0, 0x00000000, bhvYellowCoin),
		TERRAIN(wf_area_1_collision),
		MACRO_OBJECTS(wf_area_1_macro_objs),
		SET_BACKGROUND_MUSIC(0x00, SEQ_LEVEL_GRASS),
		SHOW_DIALOG(0x00, DIALOG_030),
		TERRAIN_TYPE(TERRAIN_STONE),
		/* Fast64 begin persistent block [area commands] */
		/* Fast64 end persistent block [area commands] */
	END_AREA(),
	FREE_LEVEL_POOL(),
	MARIO_POS(1, 0, 0, 0, 0),
	CALL(0, lvl_init_or_update),
	CALL_LOOP(1, lvl_init_or_update),
	CLEAR_LEVEL(),
	SLEEP_BEFORE_EXIT(1),
	EXIT(),
};