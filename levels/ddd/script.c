#include <ultra64.h>
#include "sm64.h"
#include "behavior_data.h"
#include "model_ids.h"
#include "seq_ids.h"
#include "dialog_ids.h"
#include "segment_symbols.h"
#include "level_commands.h"

#include "game/level_update.h"

#include "levels/scripts.h"

#include "actors/common1.h"
#include "make_const_nonconst.h"
#include "levels/ddd/header.h"

/* Fast64 begin persistent block [scripts] */
/* Fast64 end persistent block [scripts] */

const LevelScript level_ddd_entry[] = {
	INIT_LEVEL(),
	LOAD_YAY0(0x07, _ddd_segment_7SegmentRomStart, _ddd_segment_7SegmentRomEnd), 
	LOAD_YAY0_TEXTURE(0x09, _water_yay0SegmentRomStart, _water_yay0SegmentRomEnd), 
	LOAD_YAY0(0x0B, _effect_yay0SegmentRomStart, _effect_yay0SegmentRomEnd), 
	LOAD_YAY0(0x0A, _water_skybox_yay0SegmentRomStart, _water_skybox_yay0SegmentRomEnd), 
	LOAD_YAY0(0x05, _group4_yay0SegmentRomStart, _group4_yay0SegmentRomEnd), 
	LOAD_RAW(0x0C, _group4_geoSegmentRomStart, _group4_geoSegmentRomEnd), 
	LOAD_YAY0(0x06, _group13_yay0SegmentRomStart, _group13_yay0SegmentRomEnd), 
	LOAD_RAW(0x0D, _group13_geoSegmentRomStart, _group13_geoSegmentRomEnd), 
	LOAD_YAY0(0x08, _common0_yay0SegmentRomStart, _common0_yay0SegmentRomEnd), 
	LOAD_RAW(0x0F, _common0_geoSegmentRomStart, _common0_geoSegmentRomEnd), 
	ALLOC_LEVEL_POOL(),
	MARIO(MODEL_MARIO, 0x00000001, bhvMario), 
	JUMP_LINK(script_func_global_1), 
	JUMP_LINK(script_func_global_5), 
	JUMP_LINK(script_func_global_14), 
	LOAD_MODEL_FROM_GEO(MODEL_DDD_BOWSER_SUB_DOOR, ddd_geo_000478), 
	LOAD_MODEL_FROM_GEO(MODEL_DDD_BOWSER_SUB, ddd_geo_0004A0), 
	LOAD_MODEL_FROM_GEO(MODEL_DDD_POLE, ddd_geo_000450), 
	/* Fast64 begin persistent block [level commands] */
	/* Fast64 end persistent block [level commands] */

	AREA(1, ddd_area_1),
		WARP_NODE(3, LEVEL_BOB, 2, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0xF1, LEVEL_CASTLE, 0x03, 0x67, WARP_NO_CHECKPOINT),
		WARP_NODE(0xF0, LEVEL_CASTLE, 0x03, 0x35, WARP_NO_CHECKPOINT),
		WARP_NODE(0x0A, LEVEL_DDD, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		OBJECT(MODEL_NONE, -3071, -2000, 0, 0, 0, 0, 0x00000000, bhvChirpChirp),
		OBJECT(MODEL_NONE, -3071, -3000, 0, 0, 0, 0, 0x00000000, bhvChirpChirp),
		OBJECT(MODEL_CLAM_SHELL, -4760, -5120, 580, 0, 90, 0, 0x00000000, bhvClamShell),
		OBJECT(MODEL_NONE, -1000, -4250, 0, 0, 90, 0, ((COIN_FORMATION_FLAG_FLYING | COIN_FORMATION_FLAG_RING | COIN_FORMATION_FLAG_VERTICAL) << 16), bhvCoinFormation),
		OBJECT(MODEL_NONE, -3760, -4560, 660, 0, 0, 0, ((COIN_FORMATION_FLAG_FLYING | COIN_FORMATION_FLAG_VERTICAL                           ) << 16), bhvCoinFormation),
		OBJECT(MODEL_NONE, -4240, -4786, 1180, 0, 0, 0, ((COIN_FORMATION_FLAG_FLYING | COIN_FORMATION_FLAG_VERTICAL                           ) << 16), bhvCoinFormation),
		OBJECT(MODEL_NONE, -4840, -1137, 1860, 0, -45, 0, ((COIN_FORMATION_FLAG_NONE                                                            ) << 16), bhvCoinFormation),
		OBJECT(MODEL_NONE, 0, -4250, 0, 0, 90, 0, ((COIN_FORMATION_FLAG_FLYING | COIN_FORMATION_FLAG_RING | COIN_FORMATION_FLAG_VERTICAL) << 16), bhvCoinFormation),
		OBJECT(MODEL_NONE, -2000, -4250, 0, 0, 90, 0, ((COIN_FORMATION_FLAG_FLYING | COIN_FORMATION_FLAG_RING | COIN_FORMATION_FLAG_VERTICAL) << 16), bhvCoinFormation),
		OBJECT(MODEL_NONE, -3071, -130, 0, 0, 0, 0, 0x00000000, bhvFewBlueFishSpawner),
		OBJECT(MODEL_NONE, -4646, -4615, -800, 0, 0, 0, (FISH_SPAWNER_BP_FEW_BLUE << 16), bhvFishSpawner),
		OBJECT(MODEL_NONE, -1804, -2560, 1292, 0, 0, 0, (FISH_SPAWNER_BP_FEW_CYAN << 16), bhvFishSpawner),
		OBJECT(MODEL_NONE, -3580, -2280, -1120, 0, 0, 0, (FISH_SPAWNER_BP_FEW_BLUE << 16), bhvFishSpawner),
		OBJECT(MODEL_NONE, -2020, -3460, -120, 0, 0, 0, (FISH_SPAWNER_BP_FEW_BLUE << 16), bhvFishSpawner),
		OBJECT(MODEL_1UP, -4760, -5080, 580, 0, 0, 0, (1 << 16), bhvHidden1up),
		OBJECT(MODEL_NONE, -4760, -5100, 580, 0, 0, 0, 0x00000000, bhvHidden1upTrigger),
		OBJECT_WITH_ACTS(MODEL_MANTA_RAY, -4640, -1380, 40, 0, 0, 0, 0x04000000, bhvMantaRay, ACT_3 | ACT_4 | ACT_5 | ACT_6),
		OBJECT(MODEL_NONE, -3071, -4270, 0, 0, 0, 0, 0x00000000, bhvManyBlueFishSpawner),
		OBJECT(MODEL_YELLOW_COIN, -2180, -5119, 1720, 0, 0, 0, 0x00000000, bhvOneCoin),
		OBJECT(MODEL_YELLOW_COIN, -1460, -5119, 1300, 0, 0, 0, 0x00000000, bhvOneCoin),
		OBJECT(MODEL_YELLOW_COIN, -1320, -5119, 840, 0, 0, 0, 0x00000000, bhvOneCoin),
		OBJECT(MODEL_NONE, -2880, -5120, -1850, 0, 0, 0, 0x00000000, bhvSeaweedBundle),
		OBJECT(MODEL_NONE, -3510, -5120, 1950, 0, 0, 0, 0x00000000, bhvSeaweedBundle),
		OBJECT(MODEL_NONE, -3071, 3000, 0, 0, 7, 0, 0x000A0000, bhvSpinAirborneWarp),
		OBJECT(MODEL_SUSHI, -3071, -270, 0, 0, 0, 0, 0x00000000, bhvSushiShark),
		OBJECT(MODEL_SUSHI, -3071, -4270, 0, 0, 0, 0, 0x00000000, bhvSushiShark),
		OBJECT(MODEL_NONE, -2400, -4607, 125, 0, 0, 0, 0x01000000, bhvTreasureChests),
		OBJECT(MODEL_DL_WHIRLPOOL, -3174, -4915, 102, 0, 0, 0, 0x00000000, bhvWhirlpool),
		TERRAIN(ddd_area_1_collision),
		MACRO_OBJECTS(ddd_area_1_macro_objs),
		SET_BACKGROUND_MUSIC(0x00, SEQ_LEVEL_WATER),
		TERRAIN_TYPE(TERRAIN_WATER),
		/* Fast64 begin persistent block [area commands] */
		/* Fast64 end persistent block [area commands] */
	END_AREA(),
	AREA(2, ddd_area_2),
		WARP_NODE(2, LEVEL_BOB, 1, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0xF3, LEVEL_CASTLE_GROUNDS, 0x01, 0x1E, WARP_NO_CHECKPOINT),
		WARP_NODE(0xF1, LEVEL_CASTLE, 0x03, 0x67, WARP_NO_CHECKPOINT),
		WARP_NODE(0xF0, LEVEL_CASTLE, 0x03, 0x35, WARP_NO_CHECKPOINT),
		OBJECT(MODEL_BLUE_COIN_SWITCH, 1614, 928, 922, 0, 0, 0, 0x00000000, bhvBlueCoinSwitch),
		OBJECT(MODEL_DDD_BOWSER_SUB_DOOR, 0, 0, 0, 0, 0, 0, 0x00000000, bhvBowserSubDoor),
		OBJECT(MODEL_DDD_BOWSER_SUB, 0, 0, 0, 0, 0, 0, 0x00000000, bhvBowsersSub),
		OBJECT(MODEL_CLAM_SHELL, 1273, -4106, 2320, 0, 90, 0, 0x00000000, bhvClamShell),
		OBJECT(MODEL_CLAM_SHELL, 1966, -4106, 3226, 0, 135, 0, 0x00000000, bhvClamShell),
		OBJECT(MODEL_CLAM_SHELL, 3886, -4006, 5130, 0, -180, 0, 0x00000000, bhvClamShell),
		OBJECT(MODEL_NONE, 4876, -4087, 4430, 0, 0, 0, ((COIN_FORMATION_FLAG_RING                                 ) << 16), bhvCoinFormation),
		OBJECT(MODEL_NONE, 3892, -4030, -3830, 0, 0, 0, ((COIN_FORMATION_FLAG_FLYING | COIN_FORMATION_FLAG_VERTICAL) << 16), bhvCoinFormation),
		OBJECT(MODEL_NONE, 3923, 110, 5953, 0, 90, 0, ((COIN_FORMATION_FLAG_NONE                                 ) << 16), bhvCoinFormation),
		OBJECT(MODEL_DDD_POLE, 5120, 1005, 3584, 0, -180, 0, 0x001E0000, bhvDDDPole),
		OBJECT(MODEL_DDD_POLE, 5605, 1005, 3380, 0, -90, 0, 0x00150000, bhvDDDPole),
		OBJECT(MODEL_DDD_POLE, 1800, 1005, 1275, 0, 0, 0, 0x000B0000, bhvDDDPole),
		OBJECT(MODEL_DDD_POLE, 4000, 1005, 1075, 0, -180, 0, 0x000B0000, bhvDDDPole),
		OBJECT(MODEL_DDD_POLE, 1830, 1005, 520, 0, -90, 0, 0x00140000, bhvDDDPole),
		OBJECT(MODEL_DDD_POLE, 4000, 1005, 1275, 0, 0, 0, 0x000B0000, bhvDDDPole),
		OBJECT(MODEL_DDD_POLE, 5760, 1005, 360, 0, -90, 0, 0x00170000, bhvDDDPole),
		OBJECT(MODEL_DDD_POLE, 3310, 1005, -1945, 0, 0, 0, 0x00170000, bhvDDDPole),
		OBJECT(MODEL_DDD_POLE, 3550, 1005, -2250, 0, 0, 0, 0x000D0000, bhvDDDPole),
		OBJECT(MODEL_EXCLAMATION_BOX, 6800, 500, -850, 0, 0, 0, (EXCLAMATION_BOX_BP_METAL_CAP  << 16), bhvExclamationBox),
		OBJECT(MODEL_EXCLAMATION_BOX, 6800, 500, -150, 0, 0, 0, (EXCLAMATION_BOX_BP_VANISH_CAP << 16), bhvExclamationBox),
		OBJECT(MODEL_BOWLING_BALL, 938, 153, 4107, 0, 0, 0, 0x00000000, bhvFireSpitter),
		OBJECT(MODEL_NONE, 2061, -3323, 2246, 0, 0, 0, (FISH_SPAWNER_BP_FEW_BLUE << 16), bhvFishSpawner),
		OBJECT(MODEL_NONE, 5661, -2923, -1415, 0, 0, 0, (FISH_SPAWNER_BP_FEW_CYAN << 16), bhvFishSpawner),
		OBJECT(MODEL_PURPLE_SWITCH, 6800, 110, 2000, 0, 0, 0, 0x00000000, bhvFloorSwitchHiddenObjects),
		OBJECT(MODEL_BLUE_COIN, 1414, 1020, 622, 0, 0, 0, 0x00000000, bhvHiddenBlueCoin),
		OBJECT(MODEL_BLUE_COIN, 1814, 1020, 622, 0, 0, 0, 0x00000000, bhvHiddenBlueCoin),
		OBJECT(MODEL_BLUE_COIN, 1814, 1020, 1222, 0, 0, 0, 0x00000000, bhvHiddenBlueCoin),
		OBJECT(MODEL_BLUE_COIN, 1414, 1020, 1222, 0, 0, 0, 0x00000000, bhvHiddenBlueCoin),
		OBJECT(MODEL_BLUE_COIN, 1414, 1020, 922, 0, 0, 0, 0x00000000, bhvHiddenBlueCoin),
		OBJECT(MODEL_BLUE_COIN, 1814, 1020, 922, 0, 0, 0, 0x00000000, bhvHiddenBlueCoin),
		OBJECT(MODEL_BREAKABLE_BOX, 6075, -100, 2000, 0, 0, 0, (BREAKABLE_BOX_BP_NO_COINS << 16), bhvHiddenObject),
		OBJECT(MODEL_BREAKABLE_BOX, 5875, 100, 2000, 0, 0, 0, (BREAKABLE_BOX_BP_NO_COINS << 16), bhvHiddenObject),
		OBJECT(MODEL_BREAKABLE_BOX, 5675, 100, 2000, 0, 0, 0, (BREAKABLE_BOX_BP_NO_COINS << 16), bhvHiddenObject),
		OBJECT(MODEL_BREAKABLE_BOX, 5475, 300, 2000, 0, 0, 0, (BREAKABLE_BOX_BP_NO_COINS << 16), bhvHiddenObject),
		OBJECT(MODEL_BREAKABLE_BOX, 5275, 300, 2000, 0, 0, 0, (BREAKABLE_BOX_BP_NO_COINS << 16), bhvHiddenObject),
		OBJECT(MODEL_BREAKABLE_BOX, 5075, 500, 2000, 0, 0, 0, (BREAKABLE_BOX_BP_NO_COINS << 16), bhvHiddenObject),
		OBJECT(MODEL_BREAKABLE_BOX, 4875, 500, 2000, 0, 0, 0, (BREAKABLE_BOX_BP_NO_COINS << 16), bhvHiddenObject),
		OBJECT(MODEL_BREAKABLE_BOX, 6275, -100, 2000, 0, 0, 0, (BREAKABLE_BOX_BP_NO_COINS << 16), bhvHiddenObject),
		OBJECT(MODEL_BREAKABLE_BOX, 6475, -100, 2000, 0, 0, 0, (BREAKABLE_BOX_BP_NO_COINS << 16), bhvHiddenObject),
		OBJECT(MODEL_BREAKABLE_BOX, 5740, 710, 3900, 0, 0, 0, (BREAKABLE_BOX_BP_NO_COINS << 16), bhvHiddenObject),
		OBJECT(MODEL_BREAKABLE_BOX, 5740, 510, 4100, 0, 0, 0, (BREAKABLE_BOX_BP_NO_COINS << 16), bhvHiddenObject),
		OBJECT(MODEL_BREAKABLE_BOX, 5740, 310, 4300, 0, 0, 0, (BREAKABLE_BOX_BP_NO_COINS << 16), bhvHiddenObject),
		OBJECT(MODEL_BREAKABLE_BOX, 5740, 110, 4500, 0, 0, 0, (BREAKABLE_BOX_BP_NO_COINS << 16), bhvHiddenObject),
		OBJECT(MODEL_BREAKABLE_BOX, 5940, 110, 4500, 0, 0, 0, (BREAKABLE_BOX_BP_NO_COINS << 16), bhvHiddenObject),
		OBJECT(MODEL_NONE, 5513, 1200, 900, 0, 0, 0, 0x02000000, bhvHiddenRedCoinStar),
		OBJECT(MODEL_NONE, 3404, -3319, -489, 0, 0, 0, 0x00000000, bhvJetStream),
		OBJECT(MODEL_NONE, 3404, -3319, -489, 0, 0, 0, 0x03000000, bhvJetStreamRingSpawner),
		OBJECT(MODEL_KOOPA_SHELL, 3886, -4050, 5100, 0, 0, 0, 0x00000000, bhvKoopaShellUnderwater),
		OBJECT(MODEL_WOODEN_SIGNPOST, 3086, 110, 6120, 0, -180, 0, (DIALOG_053 << 16), bhvMessagePanel),
		OBJECT(MODEL_RED_COIN, 4680, 1155, -2200, 0, 0, 0, 0x00000000, bhvRedCoin),
		OBJECT(MODEL_RED_COIN, 3525, 1155, -2250, 0, 0, 0, 0x00000000, bhvRedCoin),
		OBJECT(MODEL_RED_COIN, 3850, 1111, 3550, 0, 0, 0, 0x00000000, bhvRedCoin),
		OBJECT(MODEL_RED_COIN, 4400, 1288, 3595, 0, 0, 0, 0x00000000, bhvRedCoin),
		OBJECT(MODEL_RED_COIN, 2974, 1015, 3584, 0, 0, 0, 0x00000000, bhvRedCoin),
		OBJECT(MODEL_RED_COIN, 5550, 1015, 3575, 0, 0, 0, 0x00000000, bhvRedCoin),
		OBJECT(MODEL_RED_COIN, 3300, 1111, -1900, 0, 0, 0, 0x00000000, bhvRedCoin),
		OBJECT(MODEL_RED_COIN, 2100, 1025, -1600, 0, 0, 0, 0x00000000, bhvRedCoin),
		OBJECT(MODEL_NONE, 6420, -4106, -2026, 0, 0, 0, 0x00000000, bhvSeaweedBundle),
		OBJECT(MODEL_NONE, 6340, -4106, -1413, 0, 0, 0, 0x00000000, bhvSeaweedBundle),
		OBJECT(MODEL_NONE, 2999, -4092, 4430, 0, 0, 0, 0x00000000, bhvSeaweedBundle),
		OBJECT(MODEL_STAR, 3900, 850, -600, 0, 0, 0, 0x00000000, bhvStar),
		OBJECT(MODEL_STAR, 2030, -3700, -2780, 0, 0, 0, 0x05000000, bhvStar),
		TERRAIN(ddd_area_2_collision),
		MACRO_OBJECTS(ddd_area_2_macro_objs),
		SET_BACKGROUND_MUSIC(0x00, SEQ_LEVEL_WATER),
		TERRAIN_TYPE(TERRAIN_WATER),
		/* Fast64 begin persistent block [area commands] */
		/* Fast64 end persistent block [area commands] */
	END_AREA(),
	FREE_LEVEL_POOL(),
	MARIO_POS(1, 0, 0, 0, 0),
	CALL(0, lvl_init_or_update),
	CALL_LOOP(1, lvl_init_or_update),
	CLEAR_LEVEL(),
	SLEEP_BEFORE_EXIT(1),
	EXIT(),
};